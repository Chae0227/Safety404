<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title th:text="${post.title}">자료 상세</title>
    <link rel="stylesheet" href="/css/header.css">
    <link rel="stylesheet" href="/css/verify.css">
    <script th:src="@{/js/header.js}" defer></script>
</head>

<body>

<th:block th:replace="~{layout/header :: siteHeader}"></th:block>

<div class="container">

    <!-- 상단 제목 + 상태 + 버튼 -->
    <div class="detail-header">
        <div class="title-row">
            <h1 class="detail-title" th:text="${post.title}">자료 제목</h1>
            <span class="status-badge"
                  th:class="'status ' + ${post.status}"
                  th:text="${post.status}">
            </span>
        </div>

        <div class="detail-buttons">
            <a href="/verify" class="btn btn-gray">목록</a>

            <!-- 작성자 (관리자 아님) -->
            <th:block th:if="${mine and !isAdmin}">
                <a th:href="@{/verify/{id}/edit(id=${post.id})}" class="btn btn-orange">수정</a>

                <form th:action="@{/verify/{id}/delete(id=${post.id})}"
                      method="post"
                      style="display:inline;">
                    <button type="submit"
                            class="btn btn-red"
                            onclick="return confirm('정말 삭제할까요?')">
                        삭제
                    </button>
                </form>
            </th:block>

            <!-- 관리자 -->
            <th:block th:if="${isAdmin}">
                <form th:action="@{/verify/{id}/approve(id=${post.id})}"
                      method="post"
                      style="display:inline;">
                    <button type="submit" class="btn btn-orange">승인</button>
                </form>

                <form th:action="@{/verify/{id}/hide(id=${post.id})}"
                      method="post"
                      style="display:inline;">
                    <button type="submit" class="btn btn-light">가리기</button>
                </form>

                <form th:action="@{/verify/{id}/delete(id=${post.id})}"
                      method="post"
                      style="display:inline;">
                    <button type="submit" class="btn btn-red">삭제</button>
                </form>
            </th:block>
        </div>
    </div>

    <!-- 본문 카드 -->
    <div class="detail-card">

        <!-- 카테고리 -->
        <div class="detail-category-row">
            <span class="detail-category"
                  th:classappend="' category-' + ${post.category}">
                📂 <span th:text="${post.category}"></span>
            </span>
        </div>

        <!-- 작성자 / 날짜 -->
        <div class="detail-meta-row">
            <div class="writer">
                👤 <span th:text="${post.writer != null ? post.writer : '비회원'}"></span>
            </div>
            <div class="date">
                🕓 <span th:text="${#temporals.format(post.createdAt, 'yyyy.MM.dd HH:mm')}"></span>
            </div>
        </div>

        <div class="detail-divider"></div>

        <!-- 첨부파일 -->
        <div class="file-row">
            <span class="file-label">📎 첨부파일</span>

            <span th:if="${post.storedFilename != null}">
                <span class="file-name" th:text="${post.originalFilename}"></span>
                <a th:href="@{/verify/{id}/download(id=${post.id})}"
                   class="btn btn-light btn-sm">
                    다운로드
                </a>
            </span>

            <span th:if="${post.storedFilename == null}" class="no-file">
                첨부된 파일이 없습니다.
            </span>
        </div>

        <div class="detail-divider"></div>

        <!-- 본문 -->
        <div class="content-area" th:text="${post.content}">
            자료 설명
        </div>

    </div>

</div>

</body>
</html>
