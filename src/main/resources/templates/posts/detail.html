<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title th:text="${post.title}">게시글 상세</title>
    <link rel="stylesheet" href="/css/header.css">
    <link rel="stylesheet" href="/css/board.css">
    <script th:src="@{/js/header.js}" defer></script>
</head>

<body>

<th:block th:replace="~{layout/header :: siteHeader}"></th:block>

<div class="container">

    <div class="detail-header">

        <h1 class="detail-title" th:text="${post.title}">게시글 제목</h1>

        <div class="detail-buttons">

            <a href="/posts" class="btn btn-gray">목록</a>

            <!-- ⭐ 일반 사용자: 자신의 글만 수정/삭제 -->
            <th:block th:if="${mine and !isAdmin}">
                <a th:href="@{|/posts/${post.id}/edit|}" class="btn btn-orange">수정</a>

                <form th:action="@{|/posts/${post.id}/delete|}" method="post" style="display:inline;">
                    <button class="btn btn-red"
                            onclick="return confirm('정말 삭제할까요?')">
                        삭제
                    </button>
                </form>
            </th:block>

            <!-- ⭐ 관리자: 가리기 + 삭제 -->
            <th:block th:if="${isAdmin}">
                <form th:action="@{|/posts/${post.id}/hide|}" method="post" style="display:inline;">
                    <button class="btn btn-orange"
                            onclick="return confirm('이 게시글을 가리시겠습니까?')">
                        가리기
                    </button>
                </form>

                <form th:action="@{|/posts/${post.id}/delete|}" method="post" style="display:inline;">
                    <button class="btn btn-red"
                            onclick="return confirm('정말 삭제할까요?')">
                        삭제
                    </button>
                </form>
            </th:block>

        </div>
    </div>

    <div class="detail-card">
		<div class="info-row">
		    <span>
		        👤 

		        <!-- ⭐ 관리자: 이름 + (username) 모두 표시 -->
		        <span th:if="${isAdmin}">
		            <span th:text="${post.writer}"></span>
		            <span th:if="${writerUsername != null}">
		                (<span th:text="${writerUsername}"></span>)
		            </span>
		        </span>

		        <!-- ⭐ 일반 사용자: writer만 -->
		        <span th:if="${!isAdmin}" th:text="${post.writer}">익명</span>
		    </span>

		    <span>
		        🕓 <span th:text="${#temporals.format(post.createdAt, 'yyyy.MM.dd HH:mm')}"></span>
		    </span>
		</div>

        <div class="detail-divider"></div>

        <div class="content-area" th:text="${post.content}">
            게시글 내용입니다.
        </div>

    </div>

</div>
</body>
</html>
